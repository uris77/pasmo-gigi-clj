(function(){var t=this,e=t._,r={},n=Array.prototype,o=Object.prototype,i=Function.prototype,a=n.push,u=n.slice,l=n.concat,s=o.toString,c=o.hasOwnProperty,f=n.forEach,d=n.map,v=n.reduce,p=n.reduceRight,y=n.filter,m=n.every,h=n.some,g=n.indexOf,S=n.lastIndexOf,_=Array.isArray,b=Object.keys,$=i.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):t._=T,T.VERSION="1.5.2";var O=T.each=T.forEach=function(t,e,n){if(null!=t)if(f&&t.forEach===f)t.forEach(e,n);else if(t.length===+t.length){for(var o=0,i=t.length;i>o;o++)if(e.call(n,t[o],o,t)===r)return}else for(var a=T.keys(t),o=0,i=a.length;i>o;o++)if(e.call(n,t[a[o]],a[o],t)===r)return};T.map=T.collect=function(t,e,r){var n=[];return null==t?n:d&&t.map===d?t.map(e,r):(O(t,function(t,o,i){n.push(e.call(r,t,o,i))}),n)};var w="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,r,n){var o=arguments.length>2;if(null==t&&(t=[]),v&&t.reduce===v)return n&&(e=T.bind(e,n)),o?t.reduce(e,r):t.reduce(e);if(O(t,function(t,i,a){o?r=e.call(n,r,t,i,a):(r=t,o=!0)}),!o)throw new TypeError(w);return r},T.reduceRight=T.foldr=function(t,e,r,n){var o=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return n&&(e=T.bind(e,n)),o?t.reduceRight(e,r):t.reduceRight(e);var i=t.length;if(i!==+i){var a=T.keys(t);i=a.length}if(O(t,function(u,l,s){l=a?a[--i]:--i,o?r=e.call(n,r,t[l],l,s):(r=t[l],o=!0)}),!o)throw new TypeError(w);return r},T.find=T.detect=function(t,e,r){var n;return C(t,function(t,o,i){return e.call(r,t,o,i)?(n=t,!0):void 0}),n},T.filter=T.select=function(t,e,r){var n=[];return null==t?n:y&&t.filter===y?t.filter(e,r):(O(t,function(t,o,i){e.call(r,t,o,i)&&n.push(t)}),n)},T.reject=function(t,e,r){return T.filter(t,function(t,n,o){return!e.call(r,t,n,o)},r)},T.every=T.all=function(t,e,n){e||(e=T.identity);var o=!0;return null==t?o:m&&t.every===m?t.every(e,n):(O(t,function(t,i,a){return(o=o&&e.call(n,t,i,a))?void 0:r}),!!o)};var C=T.some=T.any=function(t,e,n){e||(e=T.identity);var o=!1;return null==t?o:h&&t.some===h?t.some(e,n):(O(t,function(t,i,a){return o||(o=e.call(n,t,i,a))?r:void 0}),!!o)};T.contains=T.include=function(t,e){return null==t?!1:g&&t.indexOf===g?-1!=t.indexOf(e):C(t,function(t){return t===e})},T.invoke=function(t,e){var r=u.call(arguments,2),n=T.isFunction(e);return T.map(t,function(t){return(n?e:t[e]).apply(t,r)})},T.pluck=function(t,e){return T.map(t,function(t){return t[e]})},T.where=function(t,e,r){return T.isEmpty(e)?r?void 0:[]:T[r?"find":"filter"](t,function(t){for(var r in e)if(e[r]!==t[r])return!1;return!0})},T.findWhere=function(t,e){return T.where(t,e,!0)},T.max=function(t,e,r){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&T.isEmpty(t))return-(1/0);var n={computed:-(1/0),value:-(1/0)};return O(t,function(t,o,i){var a=e?e.call(r,t,o,i):t;a>n.computed&&(n={value:t,computed:a})}),n.value},T.min=function(t,e,r){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&T.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return O(t,function(t,o,i){var a=e?e.call(r,t,o,i):t;a<n.computed&&(n={value:t,computed:a})}),n.value},T.shuffle=function(t){var e,r=0,n=[];return O(t,function(t){e=T.random(r++),n[r-1]=n[e],n[e]=t}),n},T.sample=function(t,e,r){return arguments.length<2||r?t[T.random(t.length-1)]:T.shuffle(t).slice(0,Math.max(0,e))};var A=function(t){return T.isFunction(t)?t:function(e){return e[t]}};T.sortBy=function(t,e,r){var n=A(e);return T.pluck(T.map(t,function(t,e,o){return{value:t,index:e,criteria:n.call(r,t,e,o)}}).sort(function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(n>r||void 0===n)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,r,n){var o={},i=null==r?T.identity:A(r);return O(e,function(r,a){var u=i.call(n,r,a,e);t(o,u,r)}),o}};T.groupBy=E(function(t,e,r){(T.has(t,e)?t[e]:t[e]=[]).push(r)}),T.indexBy=E(function(t,e,r){t[e]=r}),T.countBy=E(function(t,e){T.has(t,e)?t[e]++:t[e]=1}),T.sortedIndex=function(t,e,r,n){r=null==r?T.identity:A(r);for(var o=r.call(n,e),i=0,a=t.length;a>i;){var u=i+a>>>1;r.call(n,t[u])<o?i=u+1:a=u}return i},T.toArray=function(t){return t?T.isArray(t)?u.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,r){return null==t?void 0:null==e||r?t[0]:u.call(t,0,e)},T.initial=function(t,e,r){return u.call(t,0,t.length-(null==e||r?1:e))},T.last=function(t,e,r){return null==t?void 0:null==e||r?t[t.length-1]:u.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,r){return u.call(t,null==e||r?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var U=function(t,e,r){return e&&T.every(t,T.isArray)?l.apply(r,t):(O(t,function(t){T.isArray(t)||T.isArguments(t)?e?a.apply(r,t):U(t,e,r):r.push(t)}),r)};T.flatten=function(t,e){return U(t,e,[])},T.without=function(t){return T.difference(t,u.call(arguments,1))},T.uniq=T.unique=function(t,e,r,n){T.isFunction(e)&&(n=r,r=e,e=!1);var o=r?T.map(t,r,n):t,i=[],a=[];return O(o,function(r,n){(e?n&&a[a.length-1]===r:T.contains(a,r))||(a.push(r),i.push(t[n]))}),i},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var e=u.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.indexOf(e,t)>=0})})},T.difference=function(t){var e=l.apply(n,u.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),e=new Array(t),r=0;t>r;r++)e[r]=T.pluck(arguments,""+r);return e},T.object=function(t,e){if(null==t)return{};for(var r={},n=0,o=t.length;o>n;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},T.indexOf=function(t,e,r){if(null==t)return-1;var n=0,o=t.length;if(r){if("number"!=typeof r)return n=T.sortedIndex(t,e),t[n]===e?n:-1;n=0>r?Math.max(0,o+r):r}if(g&&t.indexOf===g)return t.indexOf(e,r);for(;o>n;n++)if(t[n]===e)return n;return-1},T.lastIndexOf=function(t,e,r){if(null==t)return-1;var n=null!=r;if(S&&t.lastIndexOf===S)return n?t.lastIndexOf(e,r):t.lastIndexOf(e);for(var o=n?r:t.length;o--;)if(t[o]===e)return o;return-1},T.range=function(t,e,r){arguments.length<=1&&(e=t||0,t=0),r=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/r),0),o=0,i=new Array(n);n>o;)i[o++]=t,t+=r;return i};var R=function(){};T.bind=function(t,e){var r,n;if($&&t.bind===$)return $.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return r=u.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,r.concat(u.call(arguments)));R.prototype=t.prototype;var o=new R;R.prototype=null;var i=t.apply(o,r.concat(u.call(arguments)));return Object(i)===i?i:o}},T.partial=function(t){var e=u.call(arguments,1);return function(){return t.apply(this,e.concat(u.call(arguments)))}},T.bindAll=function(t){var e=u.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return O(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var r={};return e||(e=T.identity),function(){var n=e.apply(this,arguments);return T.has(r,n)?r[n]:r[n]=t.apply(this,arguments)}},T.delay=function(t,e){var r=u.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(u.call(arguments,1)))},T.throttle=function(t,e,r){var n,o,i,a=null,u=0;r||(r={});var l=function(){u=r.leading===!1?0:new Date,a=null,i=t.apply(n,o)};return function(){var s=new Date;u||r.leading!==!1||(u=s);var c=e-(s-u);return n=this,o=arguments,0>=c?(clearTimeout(a),a=null,u=s,i=t.apply(n,o)):a||r.trailing===!1||(a=setTimeout(l,c)),i}},T.debounce=function(t,e,r){var n,o,i,a,u;return function(){i=this,o=arguments,a=new Date;var l=function(){var s=new Date-a;e>s?n=setTimeout(l,e-s):(n=null,r||(u=t.apply(i,o)))},s=r&&!n;return n||(n=setTimeout(l,e)),s&&(u=t.apply(i,o)),u}},T.once=function(t){var e,r=!1;return function(){return r?e:(r=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return function(){var r=[t];return a.apply(r,arguments),e.apply(this,r)}},T.compose=function(){var t=arguments;return function(){for(var e=arguments,r=t.length-1;r>=0;r--)e=[t[r].apply(this,e)];return e[0]}},T.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},T.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var r in t)T.has(t,r)&&e.push(r);return e},T.values=function(t){for(var e=T.keys(t),r=e.length,n=new Array(r),o=0;r>o;o++)n[o]=t[e[o]];return n},T.pairs=function(t){for(var e=T.keys(t),r=e.length,n=new Array(r),o=0;r>o;o++)n[o]=[e[o],t[e[o]]];return n},T.invert=function(t){for(var e={},r=T.keys(t),n=0,o=r.length;o>n;n++)e[t[r[n]]]=r[n];return e},T.functions=T.methods=function(t){var e=[];for(var r in t)T.isFunction(t[r])&&e.push(r);return e.sort()},T.extend=function(t){return O(u.call(arguments,1),function(e){if(e)for(var r in e)t[r]=e[r]}),t},T.pick=function(t){var e={},r=l.apply(n,u.call(arguments,1));return O(r,function(r){r in t&&(e[r]=t[r])}),e},T.omit=function(t){var e={},r=l.apply(n,u.call(arguments,1));for(var o in t)T.contains(r,o)||(e[o]=t[o]);return e},T.defaults=function(t){return O(u.call(arguments,1),function(e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var x=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var o=s.call(t);if(o!=s.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var i=r.length;i--;)if(r[i]==t)return n[i]==e;var a=t.constructor,u=e.constructor;if(a!==u&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(u)&&u instanceof u))return!1;r.push(t),n.push(e);var l=0,c=!0;if("[object Array]"==o){if(l=t.length,c=l==e.length)for(;l--&&(c=x(t[l],e[l],r,n)););}else{for(var f in t)if(T.has(t,f)&&(l++,!(c=T.has(e,f)&&x(t[f],e[f],r,n))))break;if(c){for(f in e)if(T.has(e,f)&&!l--)break;c=!l}}return r.pop(),n.pop(),c};T.isEqual=function(t,e){return x(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=_||function(t){return"[object Array]"==s.call(t)},T.isObject=function(t){return t===Object(t)},O(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return s.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==s.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return c.call(t,e)},T.noConflict=function(){return t._=e,this},T.identity=function(t){return t},T.times=function(t,e,r){for(var n=Array(Math.max(0,t)),o=0;t>o;o++)n[o]=e.call(r,o);return n},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};L.unescape=T.invert(L.escape);var N={escape:new RegExp("["+T.keys(L.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(L.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return L[t][e]})}}),T.result=function(t,e){if(null==t)return void 0;var r=t[e];return T.isFunction(r)?r.call(t):r},T.mixin=function(t){O(T.functions(t),function(e){var r=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),B.call(this,r.apply(T,t))}})};var P=0;T.uniqueId=function(t){var e=++P+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,r){var n;r=T.defaults({},r,T.templateSettings);var o=new RegExp([(r.escape||H).source,(r.interpolate||H).source,(r.evaluate||H).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(o,function(e,r,n,o,u){return a+=t.slice(i,u).replace(I,function(t){return"\\"+j[t]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),i=u+e.length,e}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(r.variable||"obj","_",a)}catch(u){throw u.source=a,u}if(e)return n(e,T);var l=function(t){return n.call(this,t,T)};return l.source="function("+(r.variable||"obj")+"){\n"+a+"}",l},T.chain=function(t){return T(t).chain()};var B=function(t){return this._chain?T(t).chain():t};T.mixin(T),O(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];T.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!=t&&"splice"!=t||0!==r.length||delete r[0],B.call(this,r)}}),O(["concat","join","slice"],function(t){var e=n[t];T.prototype[t]=function(){return B.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(t,e,r){"use strict";function n(){function t(t,r){return e.extend(new(e.extend(function(){},{prototype:t})),r)}function r(t,e){var r=e.caseInsensitiveMatch,n={originalPath:t,regexp:t},o=n.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,r,n){var i="?"===n?n:null,a="*"===n?n:null;return o.push({name:r,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(a&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),n.regexp=new RegExp("^"+t+"$",r?"i":""),n}var n={};this.when=function(t,o){if(n[t]=e.extend({reloadOnSearch:!0},o,t&&r(t,o)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";n[i]=e.extend({redirectTo:t},r(i,o))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(r,o,i,a,u,l,s,c){function f(t,e){var r=e.keys,n={};if(!e.regexp)return null;var o=e.regexp.exec(t);if(!o)return null;for(var i=1,a=o.length;a>i;++i){var u=r[i-1],l="string"==typeof o[i]?decodeURIComponent(o[i]):o[i];u&&l&&(n[u.name]=l)}return n}function d(){var t=v(),n=m.current;t&&n&&t.$$route===n.$$route&&e.equals(t.pathParams,n.pathParams)&&!t.reloadOnSearch&&!y?(n.params=t.params,e.copy(n.params,i),r.$broadcast("$routeUpdate",n)):(t||n)&&(y=!1,r.$broadcast("$routeChangeStart",t,n),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?o.path(p(t.redirectTo,t.params)).search(t.params).replace():o.url(t.redirectTo(t.pathParams,o.path(),o.search())).replace()),a.when(t).then(function(){if(t){var r,n,o=e.extend({},t.resolve);return e.forEach(o,function(t,r){o[r]=e.isString(t)?u.get(t):u.invoke(t)}),e.isDefined(r=t.template)?e.isFunction(r)&&(r=r(t.params)):e.isDefined(n=t.templateUrl)&&(e.isFunction(n)&&(n=n(t.params)),n=c.getTrustedResourceUrl(n),e.isDefined(n)&&(t.loadedTemplateUrl=n,r=l.get(n,{cache:s}).then(function(t){return t.data}))),e.isDefined(r)&&(o.$template=r),a.all(o)}}).then(function(o){t==m.current&&(t&&(t.locals=o,e.copy(t.params,i)),r.$broadcast("$routeChangeSuccess",t,n))},function(e){t==m.current&&r.$broadcast("$routeChangeError",t,n,e)}))}function v(){var r,i;return e.forEach(n,function(n,a){!i&&(r=f(o.path(),n))&&(i=t(n,{params:e.extend({},o.search(),r),pathParams:r}),i.$$route=n)}),i||n[null]&&t(n[null],{params:{},pathParams:{}})}function p(t,r){var n=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)n.push(t);else{var o=t.match(/(\w+)(.*)/),i=o[1];n.push(r[i]),n.push(o[2]||""),delete r[i]}}),n.join("")}var y=!1,m={routes:n,reload:function(){y=!0,r.$evalAsync(d)}};return r.$on("$locationChangeSuccess",d),m}]}function o(){this.$get=function(){return{}}}function i(t,r,n){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(o,i,a,u,l){function s(){f&&(f.$destroy(),f=null),d&&(n.leave(d),d=null)}function c(){var a=t.current&&t.current.locals,u=a&&a.$template;if(e.isDefined(u)){var c=o.$new(),y=t.current,m=l(c,function(t){n.enter(t,null,d||i,function(){!e.isDefined(v)||v&&!o.$eval(v)||r()}),s()});d=m,f=y.scope=c,f.$emit("$viewContentLoaded"),f.$eval(p)}else s()}var f,d,v=a.autoscroll,p=a.onload||"";o.$on("$routeChangeSuccess",c),c()}}}function a(t,e,r){return{restrict:"ECA",priority:-400,link:function(n,o){var i=r.current,a=i.locals;o.html(a.$template);var u=t(o.contents());if(i.controller){a.$scope=n;var l=e(i.controller,a);i.controllerAs&&(n[i.controllerAs]=l),o.data("$ngControllerController",l),o.children().data("$ngControllerController",l)}u(n)}}}var u=e.module("ngRoute",["ng"]).provider("$route",n);u.provider("$routeParams",o),u.directive("ngView",i),u.directive("ngView",a),i.$inject=["$route","$anchorScroll","$animate"],a.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t){function e(t,e){return{redirectHome:function(){t.location.href="http://"+e.host()+":"+e.port()}}}t.module("url_utils",[]).factory("urlUtils",["$window","$location",e])}(angular),utils={isNumber:function(t){var e=parseInt(t.trim());return!_.isUndefined(t)&&!_.isEmpty(t.trim())&&(e>0||0>e)&&_.isNumber(e)}},function(t){function e(t){return{fetchSurveys:function(e){return t.get("/api/outletSurveys/"+e+"/hotspot")},createSurvey:function(e,r){return t.post("/api/outletSurveys/"+e,r)}}}t.module("OutletSurveyService",[]).factory("OutletSurveyService",["$http",e])}(angular),function(t){function e(t){return{list:function(){return t.get(i.apiUrls.list)},fetch:function(e){return t.get(i.apiUrls.getById(e))}}}function r(t,e,r){console.log("List Controller"),r.list().success(function(e){t.surveys=e}).error(function(t,r,n){401==r&&e.redirectHome(),console.error("ERROR: ",t)})}function n(t,e,r,n){n.fetch(e.id).success(function(e){t.survey=e.survey,t.locations=e.locations}).error(function(t,e,n){console.error("ERROR: ",t),401==e&&r.redirectHome()})}function o(t){t.state("surveys",{url:"surveys",templateUrl:"/tmpl/surveys/index.html"}).state("surveys.list",{url:"/list",templateUrl:"/tmpl/surveys/list.html",controller:"SurveysListController"}).state("surveys.show",{url:"/:id",templateUrl:"/tmpl/surveys/show.html",controller:"SurveyShowController"})}var i={apiUrls:{create:"/api/surveys",list:"/api/surveys",getById:function(t){return"/api/surveys/"+t}}};t.module("surveys.list",[]).config(["$stateProvider",o]).factory("SurveyRepositoryService",["$http",e]).controller("SurveysListController",["$scope","urlUtils","SurveyRepositoryService",r]).controller("SurveyShowController",["$scope","$stateParams","urlUtils","SurveyRepositoryService",n])}(angular),function(t){function e(t){return{create:function(e){return t.post(o.apiUrls.create,e)}}}function r(t,e,r,n){t.months=[{name:"January"},{name:"February"},{name:"March"},{name:"April"},{name:"May"},{name:"June"},{name:"July"},{name:"August"},{name:"September"},{name:"October"},{name:"November"},{name:"December"}],t.submit=function(){var i=o.validateSurveyForm(t.month,t.year);i.length>0?t.errors=i:n.create({month:t.month.name,year:t.year}).success(function(){e.transitionTo("surveys.list")}).error(function(e,n){t.errors=e.errors,401==n&&r.redirectHome()})}}function n(t){t.state("surveysCreate",{url:"/surveys/create",templateUrl:"/surveys/create.html",controller:"SurveysCreateController"})}var o={apiUrls:{create:"/api/surveys",list:"/api/surveys",getById:function(t){return"/api/surveys/"+t}}};o.isYear=function(t){return utils.isNumber(t)&&parseInt(t)>2010&&parseInt(t)<2030},o.validateSurveyForm=function(t,e){var r=[];return o.isYear(e)||r.push("Year: Provide a valid year! (E.g. 2014)"),_.isUndefined(t)&&r.push("Month: Select a month."),r},t.module("surveys.create",[]).config(["$stateProvider",n]).factory("CreateSurveyService",["$http",e]).controller("SurveysCreateController",["$scope","$state","urlUtils","CreateSurveyService",r])}(angular),function(t){angular.module("surveys",["surveys.list","surveys.create"])}(angular),function(t){function e(t){var e=[];return(_.isUndefined(t.name)||_.isEmpty(t.name.trim()))&&e.push("Name: provide a name for the location."),_.isUndefined(t.district)&&e.push("District: select a district."),_.isUndefined(t.locationType)&&e.push("Type of location: select what type of outlet this location is."),_.isUndefined(t.loc)?(e.push("Latitude: specify the latitude."),e.push("Longitude: specify the longitude.")):((_.isUndefined(t.loc.lon)||!utils.isNumber(t.loc.lon))&&e.push("Longitude: specify a valid longitude"),(_.isUndefined(t.loc.lat)||!utils.isNumber(t.loc.lat))&&e.push("Latitude: specify a valid latitude.")),e}function r(t){return{create:function(e){return t.post(o.locations.create,e)}}}function n(t,r,n,o){t.districts=[{name:"Corozal"},{name:"Orange Walk"},{name:"Belize"},{name:"Cayo"},{name:"Stann Creek"},{name:"Toledo"}],t.locationTypes=[{name:"Traditional"},{name:"Non-Traditional"},{name:"Hotspot"}],t.submit=function(){var i={name:t.name,district:t.district?t.district.name:void 0,locationType:t.locationType?t.locationType.name:void 0,loc:{lon:t.longitude,lat:t.latitude}},a=e(i);a.length>0?t.errors=a:o.create(i).success(function(){r.transitionTo("locations.list")}).error(function(e,r){t.errors=e.errors,401==r&&n.redirectHome()})}}var o={locations:{create:"/api/locations"}};t.module("location.create",[]).factory("LocationCreateService",["$http",r]).controller("LocationCreateController",["$scope","$state","urlUtils","LocationCreateService",n])}(angular),function(t){function e(t){return{list:function(){return t.get(n.locations.list)},search:function(e){return t.get(n.locations.list+"/search?locationName="+e)},remove:function(e){return t["delete"](n.locations.list+"/"+e)}}}function r(t,e,r){t.getList=function(){r.list().success(function(e){t.locations=e}).error(function(t,r){console.error("ERROR: ",t),401==r&&e.redirectHome()})},t.getList(),t.search=function(n){r.search(n).success(function(e){t.locations=e}).error(function(t,r){console.error("Error executing search: ",t),401==r&&e.redirectHome()})},t.remove=function(e){confirm("You are about to delete "+e.name+"! Do you want to continue?")&&(r.remove(e.id),t.locations=_.filter(t.locations,function(t){return t.id!=e.id}))}}var n={locations:{list:"/api/locations"}};t.module("locations.list",[]).factory("LocationListService",["$http",e]).controller("LocationListController",["$scope","urlUtils","LocationListService",r])}(angular),function(t){function e(t){var e="/api/locations/";return{fetchDetails:function(r){return t.get(e+r)}}}function r(t,e,r,n){t.summary=!0,t.locationId=e.locationId,n.fetchDetails(t.locationId).success(function(e){t.surveys=e.surveys,t.location=e.location}).error(function(t,e){401==e?r.redirectHome():(alert("An error occurred fetching the data from the server!"),console.error("ERROR fetching data: ",t))}),t.showMore=function(e){t.summary=!1,t.survey=e},t.showLess=function(){t.summary=!0}}t.module("locations.details",[]).factory("LocationSurveysGateway",["$http",e]).controller("LocationDetailsController",["$scope","$stateParams","urlUtils","LocationSurveysGateway",r])}(angular),function(t){function e(t){var e=[];return(_.isUndefined(t.name)||_.isEmpty(t.name.trim()))&&e.push("Name: provide a name for the location."),_.isUndefined(t.district)&&e.push("District: select a district."),_.isUndefined(t.locationType)&&e.push("Type of location: select what type of outlet this location is."),(_.isUndefined(t.longitude)||!utils.isNumber(t.longitude))&&e.push("Longitude: specify a valid longitude"),(_.isUndefined(t.latitude)||!utils.isNumber(t.latitude))&&e.push("Latitude: specify a valid latitude."),e}function r(t){return{update:function(e,r){return t.put("/api/locations/"+e,r)},fetch:function(e){return t.get("/api/locations/"+e)}}}function n(t,r,n,o,i,a){function u(){var r={name:l.name,district:l.district?l.district.name:void 0,locationType:l.locationType?l.locationType.name:void 0,loc:{lon:l.longitude,lat:l.latitude}},u=e(l);console.log("ERRORS: ",u),u.length>0?l.errors=u:i.update(a.id,r).success(function(){n.transitionTo("locations.list")}).error(function(e,r){t.errors=e.errors,401==r&&o.redirectHome()})}var l=this,s=[{name:"Corozal"},{name:"Orange Walk"},{name:"Belize"},{name:"Cayo"},{name:"Stann Creek"},{name:"Toledo"}],c=[{name:"Traditional"},{name:"Non-Traditional"},{name:"Hotspot"}],f=_.findWhere(c,{name:a.locationType}),d=_.findWhere(s,{name:a.district});_.extend(l,{districts:s,locationTypes:c,district:d,locationType:f,outlet:a,name:a.name,longitude:""+a.loc.lon,latitude:""+a.loc.lat,submit:u})}t.module("location.edit",[]).factory("LocationUpdateService",["$http",r]).controller("LocationEditController",["$scope","$stateParams","$state","urlUtils","LocationUpdateService","outlet",n])}(angular),function(t){function e(t){t.state("locations",{url:"/locations",templateUrl:"/tmpl/locations/index.html"}).state("locations.list",{url:"/list",templateUrl:"/tmpl/locations/list.html",controller:"LocationListController"}).state("locations.create",{url:"/create",templateUrl:"/tmpl/locations/create.html",controller:"LocationCreateController"}).state("locations.edit",{url:"/edit/:locationId",templateUrl:"/tmpl/locations/edit.html",controller:"LocationEditController",controllerAs:"ctrl",resolve:{outlet:["$stateParams","LocationUpdateService",function(t,e){return e.fetch(t.locationId).then(function(t){var e=t.data.location;return e.loc.lat=e.loc.coordinates[1],e.loc.lon=e.loc.coordinates[0],e})}]}}).state("locations.summary",{url:"/:locationId/summary",templateUrl:"/tmpl/locations/surveys_summary.html",controller:"LocationDetailsController"})}t.module("PasmoLocation",["location.create","locations.list","locations.details","location.edit"]).config(["$stateProvider",e])}(angular),function(t){function e(t){return{fetchOutlets:function(){return t.get("/api/locations/byType/non_traditional")},fetchSurveys:function(e){return t.get("/api/outletSurveys/"+e+"/non-traditional")},createSurvey:function(e,r){return t.post("/api/outletSurveys/"+e,r)},fetchSurvey:function(e,r){return t.get("/api/outletSurveys/"+r)},editSurvey:function(e,r,n){return t.put("/api/outletSurveys/"+r,n)}}}t.module("NonTraditionalOutletSurvey.gatewayService",[]).factory("NonTraditionalSurveyGatewayService",["$http",e])}(angular),function(t){function e(t,e,r,n,o){t.surveyId=r.id,o.fetchSurveys(r.id).success(function(e){t.surveys=e}).error(function(t,e){console.error("Error retrieving surveys: ",t),401==e&&n.redirectHome()})}t.module("NonTraditionalOutletSurvey.list",[]).controller("NonTraditionalOutletSurveyListController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",e])}(angular),function(t){function e(t,e,r,n,o){t.outlet_types=[{name:"Restaurant"},{name:"Barber Shop"},{name:"Other"}],o.fetchOutlets().success(function(e){t.locations=e,0==t.locations.length&&(t.noLocatons=!0)}).error(function(t,e){console.error("Error retreiving outlets: ",t),401==e&&n.redirectHome()}),t.cancel=function(){e.transitionTo("listNonTraditionalOutlets",{id:r.id})},t.submit=function(){if(t.errors=[],t.location||(t.errors=["Please chose a location!"]),t.outlet_type||t.errors.push("Please select an outlet type!"),0==t.errors.length){var i={outreach:t.outreach,outletType:"non-traditional",locationType:t.outlet_type.name,targetPopulations:t.target_populations,condomsAvailable:_.isBoolean(t.condoms_available)?t.condoms_available:!1,lubesAvailable:_.isBoolean(t.lube_available)?t.lube_available:!1,gigi:_.isBoolean(t.gigi)?t.gigi:!1,location:{id:t.location.id,name:t.location.name,district:t.location.district,loc:t.location.loc},notes:t.notes};o.createSurvey(r.id,i).success(function(t){e.transitionTo("listNonTraditionalOutlets",{id:r.id})}).error(function(t,e){401==e?n.redirectHome():(console.error("ERROR: ",t),alert("An error occurred!"))})}}}t.module("NonTraditionalOutletSurvey.create",[]).controller("NonTraditionalOutletSurveyCreateController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",e])}(angular),function(t){function e(t,e,r,n,o){t.survey_id=r.survey_id,t.outlet_survey_id=r.outlet_survey_id,o.fetchSurvey(t.survey_id,t.outlet_survey_id).success(function(e){t.survey=e}).error(function(t){console.error("Error fetching survey data: ",t),401==status&&n.redirectHome()}),t.cancel=function(){e.transitionTo("listNonTraditionalOutlets",{id:t.survey_id})},t.submit=function(){var e={outreach:t.survey.outreach,targetPopulations:t.survey.targetPopulations,condomsAvailable:_.isBoolean(t.survey.condomsAvailable)?t.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(t.survey.lubesAvailable)?t.survey.lubesAvailable:!1,gigi:_.isBoolean(t.survey.gigi)?t.survey.gigi:!1,notes:t.survey.notes};o.editSurvey(t.survey_id,t.outlet_survey_id,e).success(function(e){t.cancel()}).error(function(t,e){401==e?n.redirectHome():(console.error("ERROR: ",t),alert("An error occurred!"))})}}t.module("NonTraditionalOutletSurvey.edit",[]).controller("NonTraditionalOutletSurveyEditController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",e])}(angular),function(){function t(t){t.state("listNonTraditionalOutlets",{url:"/surveys/:id/non_traditional_outlet/list",templateUrl:"/tmpl/surveys/non_traditional_outlets/list.html",controller:"NonTraditionalOutletSurveyListController"}).state("createNonTraditionalOutlets",{url:"/surveys/:id/non_traditional_outlet/create",templateUrl:"/tmpl/surveys/non_traditional_outlets/create_form.html",controller:"NonTraditionalOutletSurveyCreateController"}).state("editNonTraditionalOutlets",{url:"/surveys/:survey_id/non_traditional_outlet/:outlet_survey_id/edit",templateUrl:"/tmpl/surveys/non_traditional_outlets/edit.html",controller:"NonTraditionalOutletSurveyEditController"})}angular.module("NonTraditionalOutletSurvey",["NonTraditionalOutletSurvey.gatewayService","NonTraditionalOutletSurvey.list","NonTraditionalOutletSurvey.create","NonTraditionalOutletSurvey.edit"]).config(["$stateProvider",t])}(angular),function(t){function e(t){return{fetchOutlets:function(){return t.get("/api/locations/byType/hotspot")},fetchSurveys:function(e){return t.get("/api/outletSurveys/"+e+"/hotspot")},createSurvey:function(e,r){return t.post("/api/outletSurveys/"+e,r)},fetchHotspotSurvey:function(e,r){return t.get("/api/outletSurveys/"+r)},editHotspotSurvey:function(e,r,n){return t.put("/api/outletSurveys/"+r,n)}}}t.module("Hotspots.gateway",[]).factory("GatewayService",["$http",e])}(angular),function(t){function e(t,e,r,n,o){t.surveyId=r.id,o.fetchSurveys(r.id).success(function(e){t.surveys=e}).error(function(t,e){console.error("Error retrieving surveys: ",t),401==e&&n.redirectHome()})}t.module("Hotspots.list",[]).controller("ListController",["$scope","$state","$stateParams","urlUtils","OutletSurveyService",e])}(angular),function(t){function e(t,e,r,n,o){o.fetchOutlets().success(function(e){t.locations=e,0==t.locations.length&&(t.noLocatons=!0)}).error(function(t,e){console.error("Error retreiving outlets: ",t),401==e&&n.redirectHome();

}),t.cancel=function(){e.transitionTo("hotspotsList",{id:r.id})},t.submit=function(){if(t.errors=[],t.location||(t.errors=["Please chose a location!"]),0==t.errors.length){var i={outletType:"hotspot",outreach:t.outreach,targetPopulations:t.target_populations,condomsAvailable:_.isBoolean(t.condoms_available)?t.condoms_available:!1,lubesAvailable:_.isBoolean(t.lube_available)?t.lube_available:!1,gigi:_.isBoolean(t.gigi)?t.gigi:!1,location:{id:t.location.id,name:t.location.name,district:t.location.district,loc:t.location.loc},notes:t.notes};o.createSurvey(r.id,i).success(function(t){e.transitionTo("hotspotsList",{id:r.id})}).error(function(t,e){401==e?n.redirectHome():(console.error("ERROR: ",t),alert("An error occurred!"))})}}}t.module("Hotspots.create",[]).controller("CreateController",["$scope","$state","$stateParams","urlUtils","GatewayService",e])}(angular),function(t){function e(t,e,r,n,o){t.surveyId=r.survey_id,t.hotspotSurveyId=r.hotspot_survey_id,o.fetchHotspotSurvey(t.surveyId,t.hotspotSurveyId).success(function(e){t.survey=e}).error(function(t,e){console.error("Error fetching hotspot survey: ",t),401==e&&n.redirectHome()}),t.cancel=function(){e.transitionTo("hotspotsList",{id:t.surveyId})},t.submit=function(){var e={outreach:t.survey.outreach,targetPopulations:t.survey.targetPopulations,condomsAvailable:_.isBoolean(t.survey.condomsAvailable)?t.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(t.survey.lubesAvailable)?t.survey.lubesAvailable:!1,gigi:_.isBoolean(t.survey.gigi)?t.survey.gigi:!1,notes:t.survey.notes};o.editHotspotSurvey(t.surveyId,t.hotspotSurveyId,e).success(function(e){t.cancel()}).error(function(t,e){401==e?n.redirectHome():(console.error("ERROR: ",t),alert("An error occurred!"))})}}t.module("Hotspots.edit",[]).controller("HotspotSurveyEditController",["$scope","$state","$stateParams","urlUtils","GatewayService",e])}(angular),function(t){function e(t){t.state("hotspotsList",{url:"/surveys/:id/hotspots/list",templateUrl:"/tmpl/surveys/hotspots/list.html",controller:"ListController"}).state("hotspotsCreate",{url:"/surveys/:id/hotspots/create",templateUrl:"/tmpl/surveys/hotspots/create_form.html",controller:"CreateController"}).state("hotspotsEdit",{url:"/surveys/:survey_id/hotspots/:hotspot_survey_id/edit",templateUrl:"/tmpl/surveys/hotspots/edit.html",controller:"HotspotSurveyEditController"})}t.module("Hotspots",["Hotspots.gateway","Hotspots.list","Hotspots.create","Hotspots.edit"]).config(["$stateProvider",e])}(angular),function(t){function e(t){return{fetchTraditionalOutlets:function(){return t.get("/api/locations/byType/traditional")},createTraditonalOutlet:function(e,r){return t.post("/api/outletSurveys/"+e,r)},fetchTraditionalOutletsSurvey:function(e){return t.get("/api/outletSurveys/"+e+"/traditional")},fetchSurvey:function(e){return t.get("/api/outletSurveys/"+e)},updateSurvey:function(e,r){return t.put("/api/outletSurveys/"+e,r)}}}t.module("TraditionalOutletSurvey.gatewayService",[]).factory("TraditionalOutletGatewayService",["$http",e])}(angular),function(t){function e(t,e,r,n,o){t.id=r.id,o.fetchTraditionalOutletsSurvey(r.id).success(function(e){t.surveys=e}).error(function(t,e){console.error("ERROR: ",t),401==e&&n.redirectHome()})}t.module("TraditionalOutletSurvey.list",[]).controller("TraditionalOutletSurveyListController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",e])}(angular),function(t){function e(t,e,r,n,o){o.fetchTraditionalOutlets().success(function(e){t.locations=e,0==e.length&&(t.noLocations=!0,console.log("No Locations: ",t.noLocations))}).error(function(t,e){console.error("ERROR: ",t),401==e&&n.redirectHome()}),t.submit=function(){var i={outletType:"traditional",condomsAvailable:_.isBoolean(t.condoms_available)?t.condoms_available:!1,lubesAvailable:_.isBoolean(t.lube_available)?t.lube_available:!1,gigi:_.isBoolean(t.gigi)?t.gigi:!1,location:{id:t.location.id,name:t.location.name,district:t.location.district,loc:t.location.loc},notes:t.notes};o.createTraditonalOutlet(r.id,i).success(function(t){e.transitionTo("surveys.listTraditionalOutlets",{id:r.id})}).error(function(t,e){401==e?n.redirectHome():console.error("ERROR: ",t)})},t.cancel=function(){e.transitionTo("surveys.listTraditionalOutlets",{id:r.id})}}t.module("TraditionalOutletSurvey.create",[]).controller("TraditionalOutletSurveyCreateController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",e])}(angular),function(t){function e(t,e,r,n,o){t.surveyId=r.survey_id,console.log("In Edit Controller::: ",r),o.fetchSurvey(r.traditional_outlet_survey_id).success(function(e){t.survey=e,console.log("survey: ",t.survey)}).error(function(t,e){401==e?n.redirectHome():(alert("Could not retrieve survey from server!"),console.log("Error retrieving traditonal outlet from server: ",t))}),t.submit=function(){var i={condomsAvailable:_.isBoolean(t.survey.condomsAvailable)?t.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(t.survey.lubesAvailable)?t.survey.lubesAvailable:!1,gigi:_.isBoolean(t.survey.gigi)?t.survey.gigi:!1,notes:t.survey.notes};o.updateSurvey(r.traditional_outlet_survey_id,i).success(function(t){e.transitionTo("surveys.listTraditionalOutlets",{id:r.survey_id})}).error(function(t,e){console.error("ERROR: ",t),401==e&&n.redirectHome()})},t.cancel=function(){e.transitionTo("surveys.listTraditionalOutlets",{id:r.survey_id})}}t.module("TraditionalOutletSurvey.edit",[]).controller("TraditionalOutletSurveyEditController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",e])}(angular),function(t){function e(t){t.state("surveys.traditionalOutlet",{url:"/:id/traditional_outlet/create",templateUrl:"/tmpl/surveys/traditional_outlets/create_form.html",controller:"TraditionalOutletSurveyCreateController"}).state("surveys.listTraditionalOutlets",{url:"/:id/traditional_outlet/list",templateUrl:"/tmpl/surveys/traditional_outlets/list.html",controller:"TraditionalOutletSurveyListController"}).state("editTraditionalOutlet",{url:"/:survey_id/traditional_outlet/:traditional_outlet_survey_id/edit",templateUrl:"/tmpl/surveys/traditional_outlets/edit.html",controller:"TraditionalOutletSurveyEditController"})}t.module("TraditionaOutletSurvey",["TraditionalOutletSurvey.gatewayService","TraditionalOutletSurvey.list","TraditionalOutletSurvey.create","TraditionalOutletSurvey.edit"]).config(["$stateProvider",e])}(angular);var PasmoApp={apiUrls:{}};angular.module("PasmoApp",["ui.router","url_utils","OutletSurveyService","surveys","PasmoLocation","TraditionaOutletSurvey","NonTraditionalOutletSurvey","Hotspots"]).run(["$rootScope","$http","$state",function(t,e,r){console.info("Starting Pasmo App......")}]);